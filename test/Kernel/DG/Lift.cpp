//////////////////////////////////////////////////////////////////////////
// This file is part of openPSTD.                                       //
//                                                                      //
// openPSTD is free software: you can redistribute it and/or modify     //
// it under the terms of the GNU General Public License as published by //
// the Free Software Foundation, either version 3 of the License, or    //
// (at your option) any later version.                                  //
//                                                                      //
// openPSTD is distributed in the hope that it will be useful,          //
// but WITHOUT ANY WARRANTY; without even the implied warranty of       //
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the        //
// GNU General Public License for more details.                         //
//                                                                      //
// You should have received a copy of the GNU General Public License    //
// along with openPSTD.  If not, see <http://www.gnu.org/licenses/>.    //
//                                                                      //
//////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////
//
// Date: 1-6-2016
//
//
// Authors: M. R. Fortuin
//
//
// Purpose:
//
//
//////////////////////////////////////////////////////////////////////////

#ifdef STAND_ALONE
#   define BOOST_TEST_MODULE Main
#endif

#include <boost/test/unit_test.hpp>
#include <kernel/DG/Lift.h>

using namespace OpenPSTD::Kernel::DG;
using namespace std;
using namespace Eigen;

BOOST_AUTO_TEST_SUITE(DG)
    BOOST_AUTO_TEST_SUITE(Lift)
        BOOST_AUTO_TEST_CASE(Lift_1D_2) {
            int N = 3;
            MatrixX<double> V(N+1, N+1);
            MatrixX<double> LiftExpected(N+1,2);

            V <<
            0.707106781186547,  -1.224744871391589,   1.581138830084190,  -1.870828693386972,
            0.707106781186547,  -0.547722557505166,  -0.316227766016838,   0.836660026534076,
            0.707106781186547,   0.547722557505166,  -0.316227766016838,  -0.836660026534076,
            0.707106781186547,   1.224744871391589,   1.581138830084190,   1.870828693386972;

            LiftExpected <<
                     8.000000000000004,  -2.000000000000003,
                    -0.894427190999917,   0.894427190999917,
                     0.894427190999917,  -0.894427190999917,
                    -2.000000000000003,   8.000000000000004;

            MatrixX<double> Lift = Lift1D<double>(N+1, 2, V);
            BOOST_CHECK(Lift.isApprox(LiftExpected));
        }

        BOOST_AUTO_TEST_CASE(Lift_1D_6) {
            int N = 6;
            MatrixX<double> V(N+1, N+1);
            MatrixX<double> LiftExpected(N+1,2);

            V <<
                    0.707106781186547	,	-1.224744871391580	,	1.581138830084190	,	-1.870828693386970	,	2.121320343559640	,	-2.345207879911710	,	2.549509756796390	,
                    0.707106781186547	,	-1.016812459073910	,	0.844182001556940	,	-0.346643573228288	,	-0.278372647949331	,	0.807538898284274	,	-1.057410345369820	,
                    0.707106781186547	,	-0.574220155261391	,	-0.269222426980870	,	0.833675471702112	,	-0.504704283282048	,	-0.365166265456773	,	0.846707059684174	,
                    0.707106781186547	,	0.000000000000000	,	-0.790569415042095	,	0.000000000000000	,	0.795495128834866	,	0.000000000000000	,	-0.796721798998873	,
                    0.707106781186547	,	0.574220155261392	,	-0.269222426980870	,	-0.833675471702112	,	-0.504704283282048	,	0.365166265456773	,	0.846707059684174	,
                    0.707106781186547	,	1.016812459073910	,	0.844182001556939	,	0.346643573228285	,	-0.278372647949334	,	-0.807538898284277	,	-1.057410345369820	,
                    0.707106781186547	,	1.224744871391580	,	1.581138830084190	,	1.870828693386970	,	2.121320343559640	,	2.345207879911710	,	2.549509756796390	;

            LiftExpected <<
                    24.500000000000000	,	3.500000000000000	,
                    -1.451626611323410	,	-1.451626611323440	,
                    1.162370412976330	,	1.162370412976330	,
                    -1.093750000000000	,	-1.093750000000000	,
                    1.162370412976330	,	1.162370412976330	,
                    -1.451626611323440	,	-1.451626611323430	,
                    3.500000000000000	,	24.500000000000000	;


            MatrixX<double> Lift = Lift1D<double>(N+1, 2, V);
            BOOST_CHECK(Lift.isApprox(LiftExpected));
        }

        BOOST_AUTO_TEST_CASE(Lift_2D_2) {
            int N = 2;
            int Np = (N+1)*(N+2)/2;
            int Nfp = N+1;
            int Nfaces=3;
            MatrixX<double> V(Np, Np);
            MatrixX<double> LiftExpected(6, 9);
            VectorX<double> r(Np);
            VectorX<double> s(Np);
            MatrixX<double> rs(Np, 2);

            r << -1,0,1,-1,0,-1;
            s << -1,-1,-1,0,0,1;
            rs << r, s;

            V <<
              0.70710678118654746,-1,1.2247448713915894,-1.7320508075688772,2.1213203435596424,2.738612787525831,
              0.70710678118654746,-1,1.2247448713915894,0,-0,-1.3693063937629153,
              0.70710678118654746,-1,1.2247448713915894,1.7320508075688772,-2.1213203435596424,2.738612787525831,
              0.70710678118654746,0.5,-0.61237243569579458,-0.8660254037844386,-1.5909902576697319,0.68465319688145776,
              0.70710678118654746,0.5,-0.61237243569579458,0.8660254037844386,1.5909902576697319,0.68465319688145776,
              0.70710678118654746,2,3.6742346141747673,-0,-0,0;

            LiftExpected <<
                4.5000000000000009,2.0000000000000022,-0.49999999999999978,1.0000000000000016,4.0000000000000027,1,4.5000000000000018,2.0000000000000027,-0.50000000000000078,
                0.50000000000000044,5.0000000000000018,0.50000000000000044,-0.62500000000000033,-1.5000000000000007,0.62500000000000022,-0.62500000000000044,-1.5000000000000007,0.62500000000000033,
                -0.5,2.0000000000000022,4.5000000000000009,4.5000000000000018,2.0000000000000022,-0.50000000000000089,1.0000000000000013,4.0000000000000027,1.0000000000000002,
                -0.62500000000000022,-1.5000000000000009,0.625,0.62500000000000022,-1.4999999999999996,-0.62500000000000033,0.50000000000000056,5.0000000000000009,0.50000000000000022,
                0.625,-1.5000000000000009,-0.62500000000000022,0.50000000000000044,5.0000000000000009,0.50000000000000033,0.62500000000000022,-1.4999999999999996,-0.62500000000000033,
                1.0000000000000009,4.0000000000000036,1.0000000000000004,-0.50000000000000067,2.0000000000000013,4.5,-0.50000000000000078,2.0000000000000009,4.5;

            MatrixX<double> Lift = Lift2D<double>(N, Nfaces, V, rs);
            BOOST_CHECK(Lift.isApprox(LiftExpected));
        }

        BOOST_AUTO_TEST_CASE(Lift_2D_6) {
            int N = 6;
            int Np = (N+1)*(N+2)/2;
            int Nfp = N+1;
            int Nfaces=3;
            MatrixX<double> V(Np, Np);
            MatrixX<double> LiftExpected(28, 21);
            VectorX<double> r(Np);
            VectorX<double> s(Np);
            MatrixX<double> rs(Np, 2);

            r << -1,-0.8302238962785673,-0.46884879347071434,0,0.46884879347071434,0.83022389627856685,1,-1,-0.76951649619344176,-0.36476925653668923,0.10886465257101041,0.53903299238688285,0.8302238962785673,-1,-0.74409539603432151,-0.33333333333333343,0.10886465257101047,0.46884879347071384,-1,-0.74409539603432129,-0.36476925653668918,0,-1,-0.76951649619344131,-0.4688487934707144,-0.99999999999999989,-0.83022389627856674,-1;
            s << -1,-1,-1,-1,-1,-1,-1,-0.83022389627856674,-0.76951649619344153,-0.74409539603432118,-0.74409539603432129,-0.76951649619344153,-0.8302238962785673,-0.46884879347071429,-0.36476925653668935,-0.33333333333333343,-0.36476925653668918,-0.46884879347071406,0,0.10886465257101041,0.10886465257101047,0,0.46884879347071412,0.53903299238688274,0.46884879347071429,0.8302238962785673,0.83022389627856696,1;
            rs << r, s;

            V <<
              0.70710678118654746,-1,1.2247448713915894,-1.4142135623730958,1.5811388300841911,-1.7320508075688796,1.8708286933869738,-1.7320508075688772,2.1213203435596424,-2.4494897427831774,2.7386127875258293,-2.9999999999999978,3.2403703492039266,2.738612787525831,-3.16227766016838,3.5355339059327386,-3.8729833462074188,4.1833001326703805,-3.7416573867739435,4.1833001326703805,-4.5825756949558416,4.9497474683058327,4.7434164902525726,-5.1961524227066356,5.6124860801609149,-5.7445626465380339,6.2048368229954338,6.7453687816160262,
              0.70710678118654746,-1,1.2247448713915894,-1.4142135623730958,1.5811388300841911,-1.7320508075688796,1.8708286933869738,-1.4379899700122722,1.7611708408850753,-2.0336249181478352,2.2736617788580022,-2.4906716888356999,2.6902328967016254,1.4621661175318095,-1.6883640031138805,1.8876483408631519,-2.0678151538558986,2.2334956373964059,-0.69328714645657541,0.77511859370187752,-0.84909987702439982,0.91713268834085593,-0.62246016389132131,0.68187094582327856,-0.73650479827646365,1.9780582482457583,-2.1365470988712736,-2.797644807595479,
              0.70710678118654746,-1,1.2247448713915894,-1.4142135623730958,1.5811388300841911,-1.7320508075688796,1.8708286933869738,-0.81206993135864469,0.99457848364281976,-1.1484403105227834,1.2839953012149552,-1.4065463804121423,1.5192437286225386,-0.46630692206786745,0.53844485396173825,-0.6019996477966969,0.6594575734168322,-0.71229558915262581,1.6673509434042235,-1.8641550259001243,2.0420795167442498,-2.2056979722582519,-1.1285530859539719,1.2362679650381141,-1.335322019193395,-0.8944710216468027,0.96613912558881521,2.2401763132470491,
              0.70710678118654746,-1,1.2247448713915894,-1.4142135623730958,1.5811388300841911,-1.7320508075688796,1.8708286933869738,0,-0,0,-0,0,-0,-1.3693063937629153,1.5811388300841895,-1.7677669529663691,1.936491673103709,-2.0916500663351898,-0,0,-0,0,1.7787811838447132,-1.9485571585149866,2.1046822800603411,0,-0,-2.1079277442550066,
              0.70710678118654746,-1,1.2247448713915894,-1.4142135623730958,1.5811388300841911,-1.7320508075688796,1.8708286933869738,0.81206993135864469,-0.99457848364281976,1.1484403105227834,-1.2839953012149552,1.4065463804121423,-1.5192437286225386,-0.46630692206786745,0.53844485396173825,-0.6019996477966969,0.6594575734168322,-0.71229558915262581,-1.6673509434042235,1.8641550259001243,-2.0420795167442498,2.2056979722582519,-1.1285530859539719,1.2362679650381141,-1.335322019193395,0.8944710216468027,-0.96613912558881521,2.2401763132470491,
              0.70710678118654746,-1,1.2247448713915894,-1.4142135623730958,1.5811388300841911,-1.7320508075688796,1.8708286933869738,1.4379899700122718,-1.7611708408850746,2.0336249181478343,-2.2736617788580018,2.4906716888356994,-2.6902328967016249,1.4621661175318066,-1.6883640031138769,1.8876483408631481,-2.0678151538558942,2.2334956373964014,0.6932871464565693,-0.77511859370187075,0.84909987702439249,-0.91713268834084793,-0.6224601638913293,0.68187094582328744,-0.73650479827647319,-1.9780582482457647,2.1365470988712807,-2.797644807595479,
              0.70710678118654746,-1,1.2247448713915894,-1.4142135623730958,1.5811388300841911,-1.7320508075688796,1.8708286933869738,1.7320508075688772,-2.1213203435596424,2.4494897427831774,-2.7386127875258293,2.9999999999999978,-3.2403703492039266,2.738612787525831,-3.16227766016838,3.5355339059327386,-3.8729833462074188,4.1833001326703805,3.7416573867739435,-4.1833001326703805,4.5825756949558416,-4.9497474683058327,4.7434164902525726,-5.1961524227066356,5.6124860801609149,5.7445626465380339,-6.2048368229954338,6.7453687816160262,
              0.70710678118654746,-0.74533584441785017,0.48127010912263402,-0.041774203588112804,-0.41084008190637405,0.71836886983749648,-0.77592706187085281,-1.5850203887905741,1.1173028096875626,-0.29738513808086409,-0.57322777866104513,1.1980834446390605,-1.3751120133994899,2.2933961715262456,-1.0745904628659866,-0.29250401720275571,1.3625344383360485,-1.8171854045772795,-2.8673895296671952,0.75660214334190212,1.0585753347204994,-2.0842422732643731,3.3265048580782652,-0.24134756081574352,-1.8705584757903353,-3.6866176557850165,-0.4123151183719394,3.9614214861125352,
              0.70710678118654746,-0.65427474429016241,0.25826513364151094,0.26101227597282733,-0.65308047140263226,0.73556860777320399,-0.47280138594144333,-1.133237099219697,0.58819101911569049,0.16668591755520809,-0.77596294212103667,0.97266330198540707,-0.68799783977199114,0.68661016230096339,-0.15326000354476324,-0.32421702922045759,0.55461209221635377,-0.46962894894670609,0.25461694482663355,0.010582840440618864,-0.17912093677429408,0.20584348409372438,-1.0677860817947511,-0.3130813295008455,0.92218458765950173,1.2781348716892589,0.68770774325921458,-0.80969804553941316,
              0.70710678118654746,-0.61614309405148182,0.17158614406587866,0.3618579400582993,-0.70119414157104953,0.67251255769959106,-0.29400171028571825,-0.41017899738099761,0.18097107340430932,0.11115506426739696,-0.31631840112553999,0.337622582819402,-0.17475569413264416,-0.81093114973491287,0.097696439224504716,0.479329094701053,-0.67681731203028295,0.4548408743107421,0.88652661521562415,0.15023187667986995,-0.71508470263648771,0.68011712865655116,0.33533107470903012,0.14968067578163971,-0.3149773167164982,-1.0011584566451452,-0.71736228541954006,0.20819911350090856,
              0.70710678118654746,-0.61614309405148182,0.17158614406587877,0.36185794005829913,-0.70119414157104953,0.67251255769959151,-0.29400171028571914,0.4101789973809975,-0.18097107340430948,-0.11115506426739662,0.31631840112553972,-0.33762258281940216,0.17475569413264469,-0.81093114973491309,0.097696439224505188,0.47932909470105262,-0.67681731203028306,0.45484087431074294,-0.88652661521562415,-0.15023187667986954,0.71508470263648727,-0.6801171286565515,0.33533107470903084,0.14968067578163968,-0.3149773167164987,1.0011584566451459,0.7173622854195405,0.20819911350090808,
              0.70710678118654746,-0.65427474429016241,0.25826513364151094,0.26101227597282733,-0.65308047140263226,0.73556860777320399,-0.47280138594144333,1.1332370992196961,-0.58819101911569005,-0.16668591755520795,0.775962942121036,-0.97266330198540629,0.68799783977199058,0.6866101623009605,-0.1532600035447626,-0.32421702922045625,0.55461209221635155,-0.46962894894670421,-0.25461694482663766,-0.010582840440619036,0.179120936774297,-0.20584348409372774,-1.067786081794754,-0.31308132950084638,0.9221845876595044,-1.2781348716892578,-0.68770774325921402,-0.80969804553940705,
              0.70710678118654746,-0.74533584441785106,0.48127010912263629,-0.04177420358811617,-0.41084008190637072,0.71836886983749482,-0.77592706187085436,1.5850203887905747,-1.1173028096875655,0.29738513808086947,0.57322777866103902,-1.1980834446390567,1.3751120133994916,2.293396171526247,-1.074590462865993,-0.29250401720274688,1.3625344383360414,-1.8171854045772791,2.8673895296671987,-0.75660214334191012,-1.0585753347204911,2.0842422732643699,3.3265048580782706,-0.24134756081575687,-1.8705584757903244,3.6866176557850237,0.41231511837192608,3.9614214861125441,
              0.70710678118654746,-0.20327319020607137,-0.513536523505012,0.65811331100264203,-0.088497411452635621,-0.57522417499709277,0.62131312026862451,-1.2720603694637609,-0.51081736326348648,1.2696534189348641,-0.45445595942812406,-0.85220593330941841,1.1734323161793518,1.4771507594381101,1.4652176060552888,-1.3541850487820419,-0.54402427957274324,1.636752743119599,-1.4821948618978087,-2.3037294821471566,0.78483137932482183,1.6547133946293395,1.3800017586010491,2.9045081310766725,0.20827986390277983,-1.2274178813844185,-3.2514106091877988,1.0584936805126475,
              0.70710678118654746,-0.047153884805034019,-0.65172070854999586,0.4894353385015347,0.30540297586599097,-0.70596147427937306,0.20161150407433237,-0.73868507050542742,-0.53203357607084889,0.72385893105653132,0.13142239865947081,-0.77401414497521726,0.3634231849281655,0.10955389466033652,0.15475078628683683,-0.063670953759439292,-0.11718703853456341,0.11144799847073407,0.38897833142417448,0.80826159113663099,0.09340588180857104,-0.68393793893051691,-0.43430388891973837,-1.1864257901387472,-0.64020329874758475,0.1812991959847898,0.61273799738226309,0.073204027320383558,
              0.70710678118654746,-1.1102230246251565e-16,-0.68041381743977158,0.41902624070313943,0.40992488187367837,-0.68426698570622302,0.038494417559403221,-3.8459253727671286e-16,-3.1401849173675493e-16,3.6259732146947161e-16,1.3513204321084694e-16,-4.1941758708061463e-16,1.0659359318515152e-16,-0.60858061945018471,-0.93697115856840874,0.26189140043946213,0.76503374739899599,-0.52793362442479408,5.5387655747403008e-16,1.2385056336555003e-15,3.0149221028904277e-16,-1.0312212197774921e-15,0.35136418446315337,1.0264004785593348,0.69289951606924816,-4.7242560863615906e-16,-1.700926593810255e-15,-0.18505812843939715,
              0.70710678118654746,-0.047153884805033797,-0.65172070854999598,0.48943533850153437,0.30540297586599147,-0.70596147427937295,0.20161150407433154,0.73868507050542687,0.53203357607084889,-0.72385893105653054,-0.1314223986594715,0.77401414497521692,-0.36342318492816433,0.10955389466033544,0.15475078628683536,-0.063670953759438584,-0.11718703853456236,0.1114479984707329,-0.38897833142417509,-0.80826159113663265,-0.093405881808571817,0.68393793893051835,-0.43430388891973781,-1.1864257901387465,-0.64020329874758519,-0.18129919598478866,-0.61273799738225965,0.073204027320384307,
              0.70710678118654746,-0.20327319020607115,-0.51353652350501222,0.65811331100264181,-0.08849741145263483,-0.57522417499709333,0.62131312026862395,1.2720603694637604,0.51081736326348737,-1.2696534189348641,0.45445595942812245,0.85220593330942007,-1.1734323161793514,1.4771507594381093,1.4652176060552891,-1.3541850487820404,-0.54402427957274524,1.6367527431195981,1.4821948618978071,2.3037294821471566,-0.78483137932481928,-1.6547133946293411,1.3800017586010471,2.9045081310766707,0.20827986390278272,1.2274178813844165,3.2514106091877948,1.0584936805126457,
              0.70710678118654746,0.5,-0.61237243569579458,-0.5303300858899106,0.59292706128157102,0.5412658773652741,-0.58463396668342815,-0.8660254037844386,-1.5909902576697319,-0.30618621784789735,1.3693063937629157,0.5625,-1.2657696676577859,0.68465319688145776,1.9764235376052375,1.7677669529663695,-0.60515364784490877,-1.895557872616265,-0.46770717334674294,-1.8301938080432916,-2.7209043188800317,-1.0827572586919012,0.29646353064078579,1.4614178688862414,2.9816332300854871,-0.17951758270431356,-1.0664563289523401,0.10539638721275041,
              0.70710678118654746,0.66329697885651562,-0.44275331265896889,-0.77959224816351913,0.24524163289442044,0.83657978528066923,-0.050527494730698314,-0.32850607312442931,-0.71300464947515851,-0.3726430941949096,0.44774079978501158,0.55106308812416327,-0.23886227224372764,-0.12407875648638809,-0.41277560353427745,-0.51184070932601955,-0.10392325805697614,0.40815795208725564,0.14751272113770481,0.65802971445676317,1.231793238024891,1.0098448617120448,-0.030069642484124678,-0.1679511886942246,-0.41522155347965345,-0.023537707841365378,-0.15782024140051482,0.016684690470211407,
              0.70710678118654746,0.66329697885651573,-0.44275331265896878,-0.77959224816351924,0.24524163289442022,0.83657978528066923,-0.050527494730698008,0.32850607312442914,0.7130046494751584,0.37264309419490965,-0.44774079978501147,-0.55106308812416338,0.23886227224372744,-0.12407875648638821,-0.41277560353427778,-0.5118407093260201,-0.10392325805697646,0.40815795208725619,-0.14751272113770478,-0.65802971445676317,-1.2317932380248908,-1.009844861712045,-0.030069642484124637,-0.16795118869422437,-0.41522155347965289,0.023537707841365395,0.15782024140051495,0.016684690470211396,
              0.70710678118654746,0.5,-0.61237243569579458,-0.5303300858899106,0.59292706128157102,0.5412658773652741,-0.58463396668342815,0.8660254037844386,1.5909902576697319,0.30618621784789735,-1.3693063937629157,-0.5625,1.2657696676577859,0.68465319688145776,1.9764235376052375,1.7677669529663695,-0.60515364784490877,-1.895557872616265,0.46770717334674294,1.8301938080432916,2.7209043188800317,1.0827572586919012,0.29646353064078579,1.4614178688862414,2.9816332300854871,0.17951758270431356,1.0664563289523401,0.10539638721275041,
              0.70710678118654746,1.2032731902060712,0.63490378701777095,-0.55300617761279236,-1.1717556136201921,-0.57522417499709222,0.62131312026862451,-0.45999043810511647,-1.505395846906306,-2.2858594951019624,-1.7384512606430775,0.10577150166522324,1.8201409985748236,0.19315545822315464,0.92358850497151002,2.1611911174416392,3.1072987368543536,2.666010450097922,-0.070085560005456501,-0.43957445624703073,-1.3714482011346456,-2.7566825498871697,0.023596303076947579,0.18297264022981305,0.71042318008512806,-0.0075892324197808251,-0.070066629938927705,0.0023666539385753757,
              0.70710678118654746,1.3085494885803242,0.93744962008423771,-0.22016852088026867,-1.1794835420321155,-1.0810602606431394,-0.0059922420142289427,8.8642235529391267e-17,3.0914529572244051e-16,5.2664220665348836e-16,5.1792422375718502e-16,1.9525288199841395e-16,-2.5940620626207342e-16,-0.072741178173650722,-0.36845059779097045,-0.93958595184303717,-1.5453434782426172,-1.7057693336144799,-1.5258612524941721e-17,-1.0108947358440199e-16,-3.3971308257865134e-16,-7.5633834315733076e-16,0.0050197480146089322,0.04104722664679223,0.17057936626087047,1.5555991772445108e-18,1.5128393512742026e-17,-0.00031600561881840397,
              0.70710678118654746,1.2032731902060714,0.63490378701777139,-0.55300617761279192,-1.1717556136201925,-0.57522417499709355,0.62131312026862351,0.4599904381051162,1.5053958469063053,2.2858594951019624,1.7384512606430791,-0.10577150166522054,-1.8201409985748227,0.19315545822315436,0.92358850497150857,2.1611911174416361,3.1072987368543501,2.6660104500979207,0.070085560005456279,0.43957445624702934,1.3714482011346418,2.756682549887163,0.023596303076947458,0.18297264022981211,0.71042318008512451,0.0075892324197807687,0.070066629938927177,0.0023666539385753518,
              0.70710678118654746,1.7453358444178511,2.5148950272704722,2.6365293256378157,1.9847074203843402,0.71836886983750881,-0.77592706187084148,-0.14703041877830231,-0.64386803119750879,-1.5812602999503311,-2.846889557519038,-4.1210705005981607,-4.96595133152403,0.019734392668243384,0.12318328827936181,0.420515179864207,1.0354507627472105,2.0434496277218908,-0.0022887782532900456,-0.018516450359965894,-0.080609073396536585,-0.2499768965826718,0.00024630743776223615,0.0024462168332876626,0.012927131890703412,-2.5321521879564022e-05,-0.00029802208011037119,2.5239752936539479e-06,
              0.70710678118654746,1.7453358444178504,2.5148950272704695,2.6365293256378104,1.9847074203843331,0.71836886983750037,-0.77592706187084937,0.1470304187783032,0.64386803119751246,1.5812602999503398,2.8468895575190523,4.1210705005981794,4.9659513315240487,0.019734392668243696,0.1231832882793637,0.42051517986421333,1.0354507627472258,2.0434496277219201,0.0022887782532901137,0.018516450359966446,0.080609073396538944,0.24997689658267905,0.00024630743776224776,0.0024462168332877775,0.012927131890704015,2.532152187956576e-05,0.00029802208011039163,2.5239752936541864e-06,
              0.70710678118654746,2,3.6742346141747673,5.6568542494923806,7.905694150420949,10.392304845413266,13.095800853708798,-0,-0,-0,-0,-0,-0,0,0,0,0,0,-0,-0,-0,-0,0,0,0,-0,-0,0;

            LiftExpected <<
                17.499999999999979,14.201576602919836,-5.6689852255454873,3.1999999999999997,-2.0499648130767274,1.3173734357024531,-0.49999999999999312,0.66666666666666674,3.8755646630619367,6.044435336938097,6.8266666666666662,6.0444353369380739,3.8755646630619411,0.66666666666666985,17.499999999999996,14.201576602919808,-5.6689852255455264,3.2000000000000117,-2.0499648130767443,1.3173734357024425,-0.50000000000000167,
                2.4429260142442843,21.000000000000011,5.8406040977335776,-1.9255127385082822,1.0280724215142678,-0.6127016653792442,0.2266118703954505,-0.25726410325451998,-1.6249950113320633,-2.6449028913536052,-2.083798642625271,0.54241612944524753,2.4986250663488616,0.66666623012450921,1.2738902508994046,-5.3890338000975913,1.514049320869594,-0.35990559298269309,0.049254387989766515,0.026985770245082547,-0.018493559570421817,
                -0.62525666551534509,3.7448723644676214,21.000000000000014,4.834603647599204,-1.3872983346207197,0.65917838901185632,-0.22609940094257353,0.16094807123942911,1.3553699653715214,2.365682720547698,0.076541860781855417,-2.6488327060642503,0.3487735795531956,0.66625733452322677,-0.42087499524291938,2.7349890183288927,1.1225747731463427,-2.1567544796692428,1.8156598538726125,-1.2544448770966676,0.48359153261364651,
                0.31250000000000239,-1.09313219643139,4.2806321964314034,21.000000000000014,4.2806321964314051,-1.0931321964313891,0.31250000000000094,-0.070312499999997669,-1.4050804226397104,-2.4832252143486069,2.2500000000000031,0.011721933219293195,-1.139041296230993,0.64843749999999944,-0.070312500000000111,-1.405080422639708,-2.4832252143486051,2.2500000000000004,0.011721933219293233,-1.1390412962309895,0.64843750000000189,
                -0.22609940094257436,0.65917838901185866,-1.3872983346207195,4.8346036475992111,21.000000000000007,3.7448723644676187,-0.62525666551534087,-0.42087499524292338,2.7349890183288972,1.1225747731463531,-2.1567544796692468,1.8156598538726167,-1.2544448770966745,0.48359153261364574,0.16094807123943133,1.3553699653715208,2.3656827205476962,0.076541860781857957,-2.6488327060642556,0.34877357955319138,0.66625733452322666,
                0.226611870395449,-0.61270166537923987,1.0280724215142598,-1.9255127385082742,5.8406040977335794,21.000000000000004,2.4429260142442875,1.2738902508993932,-5.3890338000976028,1.5140493208695891,-0.35990559298269598,0.049254387989769381,0.026985770245079015,-0.0184935595704213,-0.25726410325452254,-1.6249950113320544,-2.6449028913536052,-2.0837986426252852,0.54241612944524575,2.4986250663488381,0.66666623012450543,
                -0.49999999999999623,1.317373435702462,-2.0499648130767296,3.2000000000000051,-5.6689852255455087,14.201576602919827,17.499999999999996,17.499999999999982,14.201576602919822,-5.6689852255455069,3.2000000000000002,-2.0499648130767412,1.3173734357024365,-0.49999999999999811,0.66666666666667074,3.8755646630619189,6.0444353369380952,6.8266666666666804,6.0444353369380854,3.8755646630619176,0.66666666666666041,
                1.2738902508993863,-5.3890338000976037,1.5140493208695991,-0.35990559298270108,0.049254387989773551,0.026985770245073759,-0.018493559570423979,0.66666623012450366,2.4986250663488505,0.54241612944524187,-2.083798642625295,-2.6449028913536035,-1.6249950113320624,-0.2572641032545257,2.4429260142442852,21.000000000000021,5.8406040977335847,-1.9255127385082946,1.028072421514246,-0.6127016653792593,0.22661187039544547,
                -0.58956417818310358,-1.4663671200251995,-2.5201939792543526,0.38841823739953174,0.061347562970506586,-0.093441728118309031,0.040347302886042463,-0.0996419367160358,-0.36688493824173929,0.4582219788479136,1.3111418831592168,0.45822197884791332,-0.36688493824173868,-0.099641936716035176,-0.5895641781831058,-1.4663671200251946,-2.52019397925435,0.3884182373995273,0.061347562970513317,-0.093441728118309489,0.040347302886043546,
                0.23831760338272145,-0.34481087741461602,-1.9495935891732048,-2.1524134418711385,0.054536093228213942,0.24352224311516416,-0.10753823391015015,-0.074414249029625068,-0.093699400886815776,-0.85397782972141389,-0.97918204692356492,0.35631586988127528,0.15209967772927635,-0.024767637987440614,0.26166610697230247,0.49970735350137307,1.4365977961281315,0.49125104060847991,-0.56664159074761966,0.19120726913061425,-0.034543119278384417,
                -0.10753823391015033,0.24352224311516396,0.054536093228212651,-2.1524134418711398,-1.9495935891732059,-0.34481087741461719,0.23831760338272093,0.26166610697230147,0.49970735350137496,1.4365977961281331,0.49125104060847746,-0.56664159074761888,0.19120726913061556,-0.034543119278384354,-0.07441424902962554,-0.093699400886815831,-0.85397782972141512,-0.97918204692356725,0.35631586988127756,0.15209967772927532,-0.024767637987441117,
                0.040347302886043421,-0.093441728118311806,0.061347562970510749,0.38841823739952641,-2.5201939792543517,-1.4663671200251978,-0.58956417818310247,-0.58956417818310003,-1.4663671200252058,-2.5201939792543522,0.3884182373995364,0.061347562970508793,-0.093441728118307005,0.040347302886042366,-0.099641936716034329,-0.36688493824173507,0.45822197884791449,1.311141883159219,0.45822197884791671,-0.36688493824173435,-0.099641936716034635,
                -0.018493559570422646,0.026985770245075758,0.049254387989766668,-0.35990559298269509,1.5140493208695935,-5.3890338000975921,1.2738902508994068,2.4429260142442835,21.00000000000006,5.8406040977335936,-1.9255127385083082,1.028072421514256,-0.61270166537926474,0.22661187039544731,0.6666662301245101,2.498625066348851,0.54241612944524342,-2.0837986426252799,-2.6449028913536123,-1.6249950113320537,-0.25726410325452392,
                -0.42087499524292471,2.7349890183288936,1.1225747731463485,-2.1567544796692459,1.8156598538726223,-1.2544448770966692,0.48359153261364685,0.66625733452322888,0.34877357955318944,-2.6488327060642636,0.076541860781861829,2.3656827205476914,1.3553699653715252,0.16094807123943017,-0.62525666551534176,3.7448723644676223,21.000000000000039,4.8346036475992129,-1.3872983346207428,0.65917838901184866,-0.22609940094257619,
                0.26166610697230341,0.49970735350137385,1.4365977961281302,0.49125104060847968,-0.56664159074761911,0.19120726913061772,-0.034543119278385048,-0.024767637987441932,0.15209967772927624,0.35631586988128089,-0.9791820469235657,-0.85397782972141079,-0.09369940088681461,-0.074414249029625179,0.23831760338272195,-0.34481087741462141,-1.9495935891732088,-2.1524134418711398,0.054536093228215267,0.24352224311516496,-0.10753823391015031,
                -0.11065386374028383,-0.10669184560113967,0.53423642721979736,1.3250663008687709,0.53423642721979647,-0.1066918456011411,-0.1106538637402831,-0.11065386374028326,-0.10669184560114101,0.53423642721979547,1.3250663008687711,0.53423642721979447,-0.10669184560114223,-0.11065386374028308,-0.1106538637402841,-0.10669184560113931,0.5342364272197988,1.3250663008687713,0.53423642721979714,-0.10669184560114016,-0.11065386374028299,
                -0.034543119278384549,0.19120726913061648,-0.56664159074761833,0.49125104060847957,1.4365977961281304,0.49970735350137313,0.26166610697230258,0.23831760338272204,-0.34481087741461902,-1.9495935891732068,-2.1524134418711371,0.054536093228214649,0.24352224311516629,-0.10753823391015023,-0.024767637987440749,0.15209967772927507,0.3563158698812775,-0.9791820469235657,-0.85397782972141367,-0.093699400886815096,-0.074414249029625276,
                0.48359153261364735,-1.2544448770966685,1.8156598538726172,-2.1567544796692402,1.12257477314634,2.7349890183288954,-0.42087499524291933,-0.62525666551534997,3.7448723644676325,21.000000000000018,4.8346036475991951,-1.3872983346207335,0.65917838901184234,-0.22609940094257255,0.66625733452322722,0.3487735795531941,-2.6488327060642627,0.076541860781862897,2.3656827205477002,1.3553699653715114,0.16094807123942742,
                -0.070312499999997891,-1.4050804226397062,-2.4832252143486051,2.2500000000000009,0.011721933219292775,-1.1390412962309906,0.64843750000000022,0.64843750000000078,-1.1390412962309924,0.011721933219291679,2.2500000000000018,-2.4832252143486002,-1.4050804226397151,-0.070312500000001138,0.31250000000000022,-1.0931321964314007,4.2806321964314069,21.000000000000025,4.2806321964313989,-1.0931321964313951,0.31250000000000122,
                -0.074414249029625623,-0.093699400886815526,-0.85397782972141256,-0.97918204692356636,0.35631586988127584,0.15209967772927449,-0.024767637987441176,-0.03454311927838466,0.19120726913061517,-0.56664159074762044,0.49125104060847957,1.4365977961281291,0.49970735350137618,0.26166610697230291,-0.10753823391015038,0.2435222431151661,0.054536093228214629,-2.1524134418711394,-1.9495935891732068,-0.34481087741461725,0.23831760338272143,
                -0.024767637987441232,0.15209967772927449,0.35631586988127656,-0.97918204692356636,-0.85397782972141312,-0.093699400886814915,-0.074414249029625512,-0.1075382339101506,0.24352224311516549,0.054536093228216689,-2.1524134418711403,-1.9495935891732021,-0.34481087741461641,0.23831760338272073,-0.0345431192783845,0.19120726913061561,-0.56664159074762133,0.49125104060847857,1.4365977961281318,0.49970735350137208,0.26166610697230186,
                0.64843750000000133,-1.1390412962309906,0.011721933219291464,2.2500000000000004,-2.4832252143486038,-1.4050804226397056,-0.07031249999999957,0.312500000000001,-1.0931321964313963,4.2806321964313945,21.000000000000021,4.2806321964313945,-1.093132196431402,0.31250000000000089,0.64843749999999967,-1.139041296230993,0.011721933219296314,2.2500000000000022,-2.4832252143486047,-1.4050804226397027,-0.070312499999997946,
                0.16094807123942842,1.3553699653715148,2.3656827205476958,0.076541860781860996,-2.6488327060642556,0.34877357955319738,0.666257334523227,0.48359153261364635,-1.2544448770966732,1.8156598538726176,-2.1567544796692433,1.1225747731463389,2.7349890183289114,-0.42087499524291755,-0.22609940094257419,0.65917838901184589,-1.3872983346207408,4.834603647599204,21.000000000000007,3.7448723644676134,-0.62525666551534609,
                -0.099641936716034524,-0.36688493824173518,0.45822197884791754,1.3111418831592192,0.45822197884791732,-0.36688493824173435,-0.099641936716034607,0.040347302886042893,-0.093441728118307366,0.061347562970510312,0.38841823739953046,-2.5201939792543464,-1.4663671200252122,-0.58956417818310236,0.040347302886042949,-0.093441728118307796,0.061347562970510638,0.38841823739953285,-2.5201939792543526,-1.4663671200251978,-0.58956417818309936,
                0.66625733452322455,0.34877357955319782,-2.6488327060642494,0.076541860781858623,2.3656827205476914,1.3553699653715165,0.16094807123942995,-0.22609940094257469,0.65917838901184456,-1.3872983346207364,4.8346036475991943,20.999999999999964,3.7448723644676236,-0.62525666551533809,0.48359153261364357,-1.2544448770966701,1.8156598538726174,-2.1567544796692402,1.1225747731463471,2.7349890183288834,-0.42087499524292321,
                -0.25726410325452348,-1.6249950113320519,-2.644902891353603,-2.0837986426252724,0.54241612944524464,2.4986250663488385,0.66666623012450532,-0.018493559570424402,0.026985770245080611,0.049254387989763726,-0.3599055929826892,1.5140493208695833,-5.3890338000975966,1.273890250899405,0.22661187039544634,-0.61270166537926074,1.0280724215142505,-1.9255127385082937,5.8406040977335572,20.999999999999975,2.4429260142442808,
                0.66666623012450932,2.4986250663488563,0.54241612944523998,-2.0837986426252986,-2.644902891353611,-1.6249950113320508,-0.25726410325452398,0.22661187039544817,-0.61270166537926207,1.0280724215142516,-1.9255127385082991,5.8406040977335962,21.000000000000121,2.4429260142443003,-0.018493559570422011,0.026985770245073908,0.049254387989774655,-0.35990559298270847,1.5140493208696144,-5.3890338000975984,1.2738902508993954,
                0.66666666666666308,3.8755646630619358,6.0444353369380952,6.8266666666666804,6.0444353369380899,3.8755646630619309,0.66666666666666785,-0.49999999999999878,1.3173734357024294,-2.0499648130767332,3.1999999999999966,-5.6689852255455069,14.20157660291988,17.499999999999986,-0.49999999999999778,1.3173734357024307,-2.0499648130767403,3.1999999999999935,-5.6689852255454847,14.201576602919816,17.499999999999968;

            MatrixX<double> Lift = Lift2D<double>(N, Nfaces, V, rs);
            BOOST_CHECK(Lift.isApprox(LiftExpected));
        }
    BOOST_AUTO_TEST_SUITE_END()
BOOST_AUTO_TEST_SUITE_END()
